# ä¸¾æŠ¥å’Œå®¡æ ¸ç³»ç»Ÿä½¿ç”¨æŒ‡å—

å®Œæ•´çš„ä¸¾æŠ¥ã€å®¡æ ¸å’Œæ•æ„Ÿè¯è¿‡æ»¤ç³»ç»Ÿï¼Œå¸®åŠ©ç»´æŠ¤å¥åº·çš„ç¤¾åŒºç¯å¢ƒã€‚

## ğŸ“‹ ç›®å½•

- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [ç»„ä»¶ API](#ç»„ä»¶-api)
- [æœåŠ¡ API](#æœåŠ¡-api)
- [æ•æ„Ÿè¯è¿‡æ»¤](#æ•æ„Ÿè¯è¿‡æ»¤)
- [æ•°æ®åº“è¡¨ç»“æ„](#æ•°æ®åº“è¡¨ç»“æ„)
- [ä½¿ç”¨åœºæ™¯](#ä½¿ç”¨åœºæ™¯)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

---

## åŠŸèƒ½ç‰¹æ€§

### 1. ä¸¾æŠ¥åŠŸèƒ½

- âœ… **å¤šç§ä¸¾æŠ¥ç±»å‹** - 10ç§ä¸¾æŠ¥ç±»å‹ï¼ˆåƒåœ¾å¹¿å‘Šã€ä¸å½“å†…å®¹ã€éªšæ‰°è¾±éª‚ã€æš´åŠ›ææ€–ã€ä»‡æ¨è¨€è®ºã€è™šå‡ä¿¡æ¯ã€ç‰ˆæƒä¾µæƒã€å†’å……ä»–äººã€æ¬ºè¯ˆè¡Œä¸ºã€éšç§æ³„éœ²ã€è¿æ³•å†…å®¹ï¼‰
- âœ… **å¤šç§æŒ‰é’®æ ·å¼** - å›¾æ ‡ã€æ–‡æœ¬ã€å›¾æ ‡+æ–‡æœ¬
- âœ… **è¯¦ç»†ä¸¾æŠ¥è¡¨å•** - é€‰æ‹©ç†ç”±ã€å¡«å†™æè¿°ã€æä¾›è¯æ®
- âœ… **ä¸¾æŠ¥é¡»çŸ¥** - é˜²æ­¢æ¶æ„ä¸¾æŠ¥
- âœ… **å·²ä¸¾æŠ¥çŠ¶æ€** - æ˜¾ç¤ºä¸¾æŠ¥çŠ¶æ€
- âœ… **æˆåŠŸæç¤º** - æäº¤æˆåŠŸåé¦ˆ

### 2. å®¡æ ¸é˜Ÿåˆ—

- âœ… **æ™ºèƒ½æ’åº** - æŒ‰ä¼˜å…ˆçº§æ’åºï¼ˆæš´åŠ›/è¿æ³•ä¼˜å…ˆï¼‰
- âœ… **çŠ¶æ€ç®¡ç†** - å¾…å®¡æ ¸ã€å®¡æ ¸ä¸­ã€å·²é€šè¿‡ã€å·²æ‹’ç»ã€å·²å¿½ç•¥
- âœ… **ç­›é€‰åŠŸèƒ½** - æŒ‰çŠ¶æ€ã€ç±»å‹ç­›é€‰
- âœ… **æœç´¢åŠŸèƒ½** - æœç´¢ç”¨æˆ·ã€å†…å®¹
- âœ… **ç»Ÿè®¡ä¿¡æ¯** - å®æ—¶ç»Ÿè®¡æ•°æ®
- âœ… **åˆ†é¡µåŠ è½½** - æ”¯æŒå¤§é‡ä¸¾æŠ¥
- âœ… **å®¡æ ¸è®°å½•** - å®Œæ•´çš„å®¡æ ¸å†å²

### 3. æ•æ„Ÿè¯è¿‡æ»¤

- âœ… **å¤šç±»åˆ«æ•æ„Ÿè¯** - 6å¤§ç±»åˆ«ï¼ˆæ”¿æ²»ã€æš´åŠ›ã€è‰²æƒ…ã€è¿æ³•ã€æ”»å‡»ã€å¹¿å‘Šï¼‰
- âœ… **ä¸¥é‡ç¨‹åº¦åˆ†çº§** - ä½ã€ä¸­ã€é«˜ã€ä¸¥é‡
- âœ… **é£é™©è¯„åˆ†** - 0-100åˆ†è¯„åˆ†ç³»ç»Ÿ
- âœ… **æ™ºèƒ½å»ºè®®** - è‡ªåŠ¨ç”Ÿæˆä¿®æ”¹å»ºè®®
- âœ… **å¯æ‰©å±•** - æ”¯æŒè‡ªå®šä¹‰æ•æ„Ÿè¯
- âœ… **å®æ—¶æ£€æµ‹** - å®æ—¶è¿‡æ»¤å†…å®¹

---

## å¿«é€Ÿå¼€å§‹

### 1. è®¿é—®ç¤ºä¾‹é¡µé¢

```bash
npm run dev
# è®¿é—® http://localhost:3000/examples/moderation-demo
```

### 2. ä½¿ç”¨ä¸¾æŠ¥æŒ‰é’®

```tsx
import { ReportButton } from '@/components/moderation';

function PostItem({ post }) {
  return (
    <div>
      <div className="post-content">{post.content}</div>
      
      <ReportButton
        targetType="post"
        targetId={post.id}
        targetTitle={post.title}
        targetContent={post.content}
        reportedUserId={post.authorId}
        reportedUserName={post.authorName}
        userId={currentUser.id}
        variant="icon"
        onSubmit={async (data) => {
          await createReport(data);
        }}
      />
    </div>
  );
}
```

### 3. ä½¿ç”¨å®¡æ ¸é˜Ÿåˆ—

```tsx
import { ModerationQueue } from '@/components/moderation';

function AdminDashboard() {
  const [reports, setReports] = useState<ReportData[]>([]);
  const moderator = useCurrentModerator();

  const handleModerate = async (reportId: string, formData: ModerationFormData) => {
    await moderateReport(reportId, formData, moderator.id, moderator.name);
    // åˆ·æ–°åˆ—è¡¨
  };

  return (
    <ModerationQueue
      reports={reports}
      moderatorId={moderator.id}
      moderatorName={moderator.name}
      onModerate={handleModerate}
      onRefresh={loadReports}
    />
  );
}
```

### 4. ä½¿ç”¨æ•æ„Ÿè¯è¿‡æ»¤

```tsx
import { moderateContent, canPublishContent } from '@/lib/utils/sensitive-words';

function PostEditor() {
  const [content, setContent] = useState('');

  const handleSubmit = async () => {
    const result = moderateContent(content);
    
    if (!result.isValid) {
      // æ˜¾ç¤ºé”™è¯¯æç¤º
      showError('å†…å®¹åŒ…å«æ•æ„Ÿè¯ï¼Œè¯·ä¿®æ”¹');
      return;
    }
    
    // å‘å¸ƒå†…å®¹
    await publishPost(content);
  };

  return (
    <textarea
      value={content}
      onChange={(e) => setContent(e.target.value)}
    />
  );
}
```

---

## ç»„ä»¶ API

### ReportButton

ä¸¾æŠ¥æŒ‰é’®ç»„ä»¶ã€‚

#### Props

```typescript
interface ReportButtonProps {
  /** ç›®æ ‡ç±»å‹ */
  targetType: ReportTargetType;
  /** ç›®æ ‡ID */
  targetId: string;
  /** ç›®æ ‡æ ‡é¢˜ */
  targetTitle?: string;
  /** ç›®æ ‡å†…å®¹ */
  targetContent?: string;
  /** è¢«ä¸¾æŠ¥ç”¨æˆ·ID */
  reportedUserId: string;
  /** è¢«ä¸¾æŠ¥ç”¨æˆ·å */
  reportedUserName: string;
  /** å½“å‰ç”¨æˆ·ID */
  userId: string;
  /** æ˜¯å¦å·²ä¸¾æŠ¥ */
  isReported?: boolean;
  /** æŒ‰é’®æ ·å¼ */
  variant?: 'icon' | 'text' | 'both';
  /** æŒ‰é’®å¤§å° */
  size?: 'sm' | 'md' | 'lg';
  /** è‡ªå®šä¹‰æ ·å¼ */
  className?: string;
  /** æäº¤æˆåŠŸå›è°ƒ */
  onSuccess?: (reportId: string) => void;
  /** æäº¤å¤±è´¥å›è°ƒ */
  onError?: (error: Error) => void;
  /** è‡ªå®šä¹‰æäº¤å‡½æ•° */
  onSubmit?: (data: ReportFormData) => Promise<void>;
}
```

#### ä½¿ç”¨ç¤ºä¾‹

```tsx
// åŸºç¡€ä½¿ç”¨
<ReportButton
  targetType="post"
  targetId={post.id}
  targetTitle={post.title}
  reportedUserId={post.authorId}
  reportedUserName={post.authorName}
  userId={currentUser.id}
/>

// è‡ªå®šä¹‰æäº¤
<ReportButton
  targetType="comment"
  targetId={comment.id}
  targetContent={comment.content}
  reportedUserId={comment.authorId}
  reportedUserName={comment.authorName}
  userId={currentUser.id}
  variant="both"
  onSubmit={async (data) => {
    await ModerationService.createReport({
      targetType: 'comment',
      targetId: comment.id,
      reportedUserId: comment.authorId,
      reason: {
        type: data.reasonType,
        description: data.description,
      },
      reporterId: currentUser.id,
    });
  }}
/>
```

### ModerationQueue

å®¡æ ¸é˜Ÿåˆ—ç»„ä»¶ã€‚

#### Props

```typescript
interface ModerationQueueProps {
  /** ä¸¾æŠ¥åˆ—è¡¨ */
  reports: ReportData[];
  /** å½“å‰ç®¡ç†å‘˜ID */
  moderatorId: string;
  /** å½“å‰ç®¡ç†å‘˜åç§° */
  moderatorName: string;
  /** å®¡æ ¸ä¸­ */
  reviewing?: boolean;
  /** åŠ è½½ä¸­ */
  loading?: boolean;
  /** è‡ªå®šä¹‰æ ·å¼ */
  className?: string;
  /** å®¡æ ¸å›è°ƒ */
  onModerate?: (reportId: string, formData: ModerationFormData) => Promise<void>;
  /** æ ‡è®°å®¡æ ¸ä¸­å›è°ƒ */
  onMarkReviewing?: (reportId: string) => Promise<void>;
  /** åˆ·æ–°å›è°ƒ */
  onRefresh?: () => Promise<void>;
  /** åˆ†é¡µå‚æ•° */
  pagination?: {
    page: number;
    pageSize: number;
    total: number;
    onPageChange: (page: number) => void;
  };
}
```

#### ä½¿ç”¨ç¤ºä¾‹

```tsx
<ModerationQueue
  reports={reports}
  moderatorId={moderator.id}
  moderatorName={moderator.name}
  onModerate={handleModerate}
  onMarkReviewing={handleMarkReviewing}
  onRefresh={loadReports}
  pagination={{
    page: currentPage,
    pageSize: 10,
    total: totalReports,
    onPageChange: setCurrentPage,
  }}
/>
```

---

## æœåŠ¡ API

### ModerationService

ä¸¾æŠ¥å’Œå®¡æ ¸æœåŠ¡ã€‚

#### åˆ›å»ºä¸¾æŠ¥

```typescript
import { ModerationService } from '@/lib/supabase/moderation';

const report = await ModerationService.createReport({
  targetType: ReportTargetType.POST,
  targetId: 'post-123',
  targetTitle: 'å¸–å­æ ‡é¢˜',
  targetContent: 'å¸–å­å†…å®¹',
  reportedUserId: 'user-456',
  reason: {
    type: ReportType.HARASSMENT,
    description: 'ç”¨æˆ·å‘å¸ƒä¸å½“å†…å®¹',
  },
  reporterId: 'user-789',
});
```

#### è·å–ä¸¾æŠ¥åˆ—è¡¨

```typescript
const { reports, total } = await ModerationService.getReports({
  status: ModerationStatus.PENDING,
  targetType: ReportTargetType.POST,
  limit: 20,
  offset: 0,
  sortBy: 'priority',
  order: 'desc',
});
```

#### è·å–å®¡æ ¸é˜Ÿåˆ—

```typescript
const { items, total } = await ModerationService.getModerationQueue({
  status: ModerationStatus.PENDING,
  limit: 20,
});

items.forEach(item => {
  console.log(item.report);
  console.log(item.priority);
  console.log(item.riskLevel);
});
```

#### å®¡æ ¸ä¸¾æŠ¥

```typescript
await ModerationService.moderateReport(
  'report-123',
  {
    action: ModerationAction.DELETE_CONTENT,
    note: 'åˆ é™¤å†…å®¹å¹¶è­¦å‘Šç”¨æˆ·',
    warningUser: true,
    notifyReporter: true,
  },
  moderatorId,
  moderatorName
);
```

#### è·å–ç»Ÿè®¡æ•°æ®

```typescript
const stats = await ModerationService.getReportStats({
  startDate: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000), // æœ€è¿‘7å¤©
  endDate: new Date(),
});

console.log(stats.totalReports);       // æ€»ä¸¾æŠ¥æ•°
console.log(stats.pendingReports);     // å¾…å®¡æ ¸æ•°
console.log(stats.approvedReports);    // å·²é€šè¿‡æ•°
console.log(stats.avgResponseTime);    // å¹³å‡å“åº”æ—¶é—´ï¼ˆå°æ—¶ï¼‰
```

#### è®¢é˜…å®æ—¶æ›´æ–°

```typescript
useEffect(() => {
  const unsubscribe = ModerationService.subscribeToReports(
    (report) => {
      console.log('æ”¶åˆ°æ–°ä¸¾æŠ¥:', report);
      // æ›´æ–°UI
    },
    {
      status: ModerationStatus.PENDING,
    }
  );

  return () => unsubscribe();
}, []);
```

---

## æ•æ„Ÿè¯è¿‡æ»¤

### æ£€æŸ¥æ•æ„Ÿè¯

```typescript
import { checkSensitiveWords } from '@/lib/utils/sensitive-words';

const matches = checkSensitiveWords('è¿™æ˜¯ä¸€æ¡åŒ…å«æš´åŠ›ææ€–çš„å†…å®¹');

matches.forEach(match => {
  console.log(match.word);      // 'æš´åŠ›'
  console.log(match.position);  // 8
  console.log(match.category);  // 'æš´åŠ›ææ€–'
  console.log(match.severity);  // 'critical'
});
```

### å†…å®¹å®¡æ ¸

```typescript
import { moderateContent } from '@/lib/utils/sensitive-words';

const result = moderateContent('è¿™æ˜¯ä¸€æ¡æµ‹è¯•å†…å®¹', {
  maxScore: 50,       // æœ€å¤§å…è®¸åˆ†æ•°
  requireAutoBan: 90, // è‡ªåŠ¨å°ç¦åˆ†æ•°
});

console.log(result.isValid);           // æ˜¯å¦é€šè¿‡
console.log(result.hasSensitiveWords); // æ˜¯å¦åŒ…å«æ•æ„Ÿè¯
console.log(result.score);             // é£é™©åˆ†æ•°
console.log(result.suggestions);      // ä¿®æ”¹å»ºè®®
```

### æ›¿æ¢æ•æ„Ÿè¯

```typescript
import { replaceSensitiveWords } from '@/lib/utils/sensitive-words';

const cleaned = replaceSensitiveWords(
  'è¿™æ˜¯ä¸€æ¡åŒ…å«æš´åŠ›å’Œææ€–çš„å†…å®¹',
  '*'
);
// 'è¿™æ˜¯ä¸€æ¡åŒ…å«**å’Œ****çš„å†…å®¹'
```

### é£é™©ç­‰çº§

```typescript
import { getRiskLevel } from '@/lib/utils/sensitive-words';

const riskLevel = getRiskLevel('è¿™æ˜¯ä¸€æ¡æµ‹è¯•å†…å®¹');
// 'none' | 'low' | 'medium' | 'high' | 'critical'
```

### æ·»åŠ è‡ªå®šä¹‰æ•æ„Ÿè¯

```typescript
import { addSensitiveWords } from '@/lib/utils/sensitive-words';

addSensitiveWords(
  'è‡ªå®šä¹‰ç±»åˆ«',
  ['æ•æ„Ÿè¯1', 'æ•æ„Ÿè¯2'],
  'high'
);
```

---

## æ•°æ®åº“è¡¨ç»“æ„

### reports è¡¨ï¼ˆä¸¾æŠ¥è¡¨ï¼‰

```sql
CREATE TABLE reports (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  target_type VARCHAR(50) NOT NULL,           -- ç›®æ ‡ç±»å‹
  target_id VARCHAR(255) NOT NULL,             -- ç›®æ ‡ID
  target_title TEXT,                          -- ç›®æ ‡æ ‡é¢˜
  target_content TEXT,                        -- ç›®æ ‡å†…å®¹
  reporter_id VARCHAR(255) NOT NULL,          -- ä¸¾æŠ¥äººID
  reporter_name VARCHAR(255),                 -- ä¸¾æŠ¥äººåç§°
  reporter_avatar TEXT,                       -- ä¸¾æŠ¥äººå¤´åƒ
  reported_user_id VARCHAR(255) NOT NULL,      -- è¢«ä¸¾æŠ¥äººID
  reported_user_name VARCHAR(255),            -- è¢«ä¸¾æŠ¥äººåç§°
  reported_user_avatar TEXT,                  -- è¢«ä¸¾æŠ¥äººå¤´åƒ
  reason_type VARCHAR(50) NOT NULL,           -- ä¸¾æŠ¥ç±»å‹
  reason_description TEXT,                    -- ä¸¾æŠ¥æè¿°
  reason_evidence TEXT,                       -- è¯æ®
  status VARCHAR(50) NOT NULL DEFAULT 'pending', -- çŠ¶æ€
  moderation_action VARCHAR(50),             -- å¤„ç†ç»“æœ
  moderator_id VARCHAR(255),                  -- å®¡æ ¸å‘˜ID
  moderator_name VARCHAR(255),                -- å®¡æ ¸å‘˜åç§°
  note TEXT,                                 -- å®¡æ ¸å¤‡æ³¨
  created_at TIMESTAMP NOT NULL DEFAULT NOW(),
  updated_at TIMESTAMP NOT NULL DEFAULT NOW(),
  reviewed_at TIMESTAMP                       -- å®¡æ ¸æ—¶é—´
);

CREATE INDEX idx_reports_status ON reports(status);
CREATE INDEX idx_reports_target ON reports(target_type, target_id);
CREATE INDEX idx_reports_reporter ON reports(reporter_id);
CREATE INDEX idx_reports_reported ON reports(reported_user_id);
```

### moderation_records è¡¨ï¼ˆå®¡æ ¸è®°å½•è¡¨ï¼‰

```sql
CREATE TABLE moderation_records (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  report_id UUID NOT NULL REFERENCES reports(id), -- ä¸¾æŠ¥ID
  moderator_id VARCHAR(255) NOT NULL,              -- å®¡æ ¸å‘˜ID
  moderator_name VARCHAR(255),                     -- å®¡æ ¸å‘˜åç§°
  action VARCHAR(50) NOT NULL,                     -- æ“ä½œ
  note TEXT,                                      -- å¤‡æ³¨
  created_at TIMESTAMP NOT NULL DEFAULT NOW()
);

CREATE INDEX idx_moderation_records_report ON moderation_records(report_id);
```

---

## ä½¿ç”¨åœºæ™¯

### 1. å¸–å­ä¸¾æŠ¥

```tsx
function PostItem({ post }) {
  return (
    <div>
      <h3>{post.title}</h3>
      <p>{post.content}</p>
      
      <div className="flex gap-2">
        <ReportButton
          targetType="post"
          targetId={post.id}
          targetTitle={post.title}
          targetContent={post.content}
          reportedUserId={post.authorId}
          reportedUserName={post.authorName}
          userId={currentUser.id}
          variant="icon"
        />
      </div>
    </div>
  );
}
```

### 2. è¯„è®ºä¸¾æŠ¥

```tsx
function CommentItem({ comment }) {
  return (
    <div>
      <p>{comment.content}</p>
      
      <ReportButton
        targetType="comment"
        targetId={comment.id}
        targetContent={comment.content}
        reportedUserId={comment.authorId}
        reportedUserName={comment.authorName}
        userId={currentUser.id}
        variant="text"
      />
    </div>
  );
}
```

### 3. ç®¡ç†å‘˜å®¡æ ¸

```tsx
function AdminModeration() {
  const [reports, setReports] = useState<ReportData[]>([]);

  useEffect(() => {
    loadReports();
  }, []);

  const handleModerate = async (reportId: string, formData: ModerationFormData) => {
    await ModerationService.moderateReport(
      reportId,
      formData,
      moderator.id,
      moderator.name
    );
    loadReports();
  };

  return (
    <ModerationQueue
      reports={reports}
      moderatorId={moderator.id}
      moderatorName={moderator.name}
      onModerate={handleModerate}
      onRefresh={loadReports}
    />
  );
}
```

### 4. å‘å¸ƒå‰å†…å®¹å®¡æ ¸

```tsx
function PostEditor() {
  const [content, setContent] = useState('');

  const handlePublish = async () => {
    const result = moderateContent(content);
    
    if (!result.isValid) {
      // æ˜¾ç¤ºæ•æ„Ÿè¯è¯¦æƒ…
      showSensitiveWordsAlert(result);
      return;
    }
    
    // å‘å¸ƒå†…å®¹
    await publishPost(content);
  };

  return (
    <div>
      <textarea
        value={content}
        onChange={(e) => setContent(e.target.value)}
      />
      <button onClick={handlePublish}>å‘å¸ƒ</button>
    </div>
  );
}
```

---

## æœ€ä½³å®è·µ

### 1. ä¸¾æŠ¥é¢‘ç‡é™åˆ¶

```typescript
// æ£€æŸ¥ç”¨æˆ·ä¸¾æŠ¥é¢‘ç‡
async function canReport(userId: string): Promise<boolean> {
  const recentReports = await getRecentReports(userId, 24); // 24å°æ—¶å†…
  return recentReports.length < 5; // æœ€å¤š5æ¬¡
}

// åœ¨ä¸¾æŠ¥æŒ‰é’®ä¸­ä½¿ç”¨
<ReportButton
  onSubmit={async (data) => {
    if (!(await canReport(currentUser.id))) {
      showError('ä¸¾æŠ¥æ¬¡æ•°è¿‡å¤šï¼Œè¯·ç¨åå†è¯•');
      return;
    }
    await createReport(data);
  }}
/>
```

### 2. æ™ºèƒ½ä¼˜å…ˆçº§æ’åº

```typescript
// åœ¨å®¡æ ¸é˜Ÿåˆ—ä¸­ï¼Œé«˜ä¼˜å…ˆçº§ä¸¾æŠ¥ä¼šæ’åœ¨å‰é¢
const { items } = await ModerationQueue.getModerationQueue({
  status: ModerationStatus.PENDING,
});

// items å·²æŒ‰ä¼˜å…ˆçº§æ’åºï¼Œæš´åŠ›ã€è¿æ³•ç­‰é«˜ä¼˜å…ˆçº§ä¸¾æŠ¥æ’åœ¨å‰é¢
```

### 3. å®¡æ ¸å“åº”æ—¶é—´

```typescript
// è®¾ç½®å®¡æ ¸å“åº”æ—¶é—´ç›®æ ‡
const TARGET_RESPONSE_TIME = 24; // 24å°æ—¶

// å®šæœŸæ£€æŸ¥è¶…æ—¶ä¸¾æŠ¥
useEffect(() => {
  const interval = setInterval(async () => {
    const stats = await ModerationService.getReportStats();
    if (stats.avgResponseTime > TARGET_RESPONSE_TIME) {
      // å‘é€å‘Šè­¦
      sendAlert('å®¡æ ¸å“åº”æ—¶é—´è¶…è¿‡ç›®æ ‡');
    }
  }, 60000); // æ¯åˆ†é’Ÿæ£€æŸ¥

  return () => clearInterval(interval);
}, []);
```

### 4. ä¸¾æŠ¥åˆ†æ

```typescript
// åˆ†æä¸¾æŠ¥ç±»å‹åˆ†å¸ƒ
async function analyzeReports() {
  const stats = await ModerationService.getReportStats();
  
  // æŒ‰ç±»å‹æ’åº
  const sortedByType = Object.entries(stats.reportsByType)
    .sort(([, a], [, b]) => b - a)
    .map(([type, count]) => ({ type, count }));
  
  // æ‰¾å‡ºæœ€å¸¸è§çš„ä¸¾æŠ¥ç±»å‹
  const topType = sortedByType[0];
  console.log('æœ€å¸¸è§çš„ä¸¾æŠ¥ç±»å‹:', topType);
  
  // æ ¹æ®åˆ†æç»“æœè°ƒæ•´ç­–ç•¥
  if (topType.type === ReportType.SPAM) {
    // åŠ å¼ºåƒåœ¾å†…å®¹è¿‡æ»¤
  }
}
```

### 5. æ•æ„Ÿè¯åº“ç®¡ç†

```typescript
// å®šæœŸæ›´æ–°æ•æ„Ÿè¯åº“
async function updateSensitiveWords() {
  const response = await fetch('/api/sensitive-words');
  const words = await response.json();
  
  // æ›´æ–°æ•æ„Ÿè¯åº“
  words.categories.forEach(category => {
    addSensitiveWords(
      category.name,
      category.words,
      category.severity
    );
  });
}

// å®šæ—¶æ›´æ–°ï¼ˆæ¯å¤©ä¸€æ¬¡ï¼‰
useEffect(() => {
  updateSensitiveWords();
  const interval = setInterval(updateSensitiveWords, 24 * 60 * 60 * 1000);
  return () => clearInterval(interval);
}, []);
```

### 6. ç”¨æˆ·ä½“éªŒä¼˜åŒ–

```typescript
// ä¸¾æŠ¥æˆåŠŸåæä¾›åé¦ˆ
<ReportButton
  onSuccess={(reportId) => {
    showToast('ä¸¾æŠ¥æäº¤æˆåŠŸï¼Œæ„Ÿè°¢ä½ çš„åé¦ˆ');
    // å¯é€‰ï¼šæ›´æ–°UIæ˜¾ç¤ºå·²ä¸¾æŠ¥çŠ¶æ€
    setReported(reportId);
  }}
  onError={(error) => {
    showToast('ä¸¾æŠ¥æäº¤å¤±è´¥: ' + error.message, 'error');
  }}
/>
```

---

## æ€»ç»“

ä¸¾æŠ¥å’Œå®¡æ ¸ç³»ç»Ÿæä¾›ï¼š

âœ… **ä¸¾æŠ¥åŠŸèƒ½** - 10ç§ä¸¾æŠ¥ç±»å‹ï¼Œå¤šç§æŒ‰é’®æ ·å¼
âœ… **å®¡æ ¸é˜Ÿåˆ—** - æ™ºèƒ½æ’åºï¼Œç­›é€‰æœç´¢ï¼Œç»Ÿè®¡ä¿¡æ¯
âœ… **æ•æ„Ÿè¯è¿‡æ»¤** - 6å¤§ç±»åˆ«ï¼Œ4çº§ä¸¥é‡ç¨‹åº¦ï¼Œé£é™©è¯„åˆ†
âœ… **å®æ—¶æ›´æ–°** - Supabase Realtime æ”¯æŒ
âœ… **å®Œæ•´æœåŠ¡** - åˆ›å»ºã€æŸ¥è¯¢ã€å®¡æ ¸ã€ç»Ÿè®¡
âœ… **ç±»å‹å®‰å…¨** - å®Œæ•´ TypeScript æ”¯æŒ
âœ… **å“åº”å¼è®¾è®¡** - é€‚é…å„ç§è®¾å¤‡
âœ… **åŠ¨ç”»æ•ˆæœ** - Framer Motion å¹³æ»‘åŠ¨ç”»

å®Œå–„çš„ä¸¾æŠ¥å’Œå®¡æ ¸ç³»ç»Ÿå¸®åŠ©ç»´æŠ¤å¥åº·çš„ç¤¾åŒºç¯å¢ƒï¼
