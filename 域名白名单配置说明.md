# 微信小程序域名白名单配置说明

## 问题描述
错误信息：`request:fail url not in domain list`

## 解决方案

### 方案一：开发环境（推荐）

在微信开发者工具中关闭域名校验：

1. 打开微信开发者工具
2. 点击右上角 **"详情"** 按钮
3. 选择 **"本地设置"** 标签
4. 勾选 **"不校验合法域名"** 选项
5. 点击 **"确定"** 保存

### 方案二：生产环境

在微信开发者工具中添加白名单域名：

1. 打开微信开发者工具
2. 点击右上角 **"详情"** 按钮
3. 选择 **"本地设置"** 标签
4. 在以下分类中添加域名：

#### request 合法域名（必须）
```
https://ohfkiswsvhksaqtgeyby.supabase.co
```

#### uploadFile 合法域名（如果使用文件上传）
```
https://ohfkiswsvhksaqtgeyby.supabase.co
```

#### downloadFile 合法域名（如果使用文件下载）
```
https://ohfkiswsvhksaqtgeyby.supabase.co
```

## 重要提示

1. **协议必须使用 https**
2. **不要在域名后添加斜杠或路径**
3. **添加域名后点击"确定"保存**
4. **修改后需要重新编译项目**

## 配置后操作

1. 清除缓存：**工具** > **清除缓存**
2. 重新编译：点击 **"编译"** 按钮
3. 重新打开小程序预览

## 常见问题

### Q: 为什么还是报错？
A: 请确保：
1. 域名完全一致（包括 https://）
2. 已保存配置
3. 已清除缓存
4. 已重新编译

### Q: 可以使用 IP 地址吗？
A: 不行，必须使用 https 域名

### Q: 需要配置多个域名吗？
A: Supabase 只需要配置这一个域名即可

## Supabase 相关域名说明

当前项目使用的 Supabase 域名：
- **API 域名**: `ohfkiswsvhksaqtgeyby.supabase.co`
- **用途**: 所有 API 请求、认证、数据库查询、文件上传/下载

## 开发调试

如果配置后仍有问题，可以：

1. 查看网络请求详细信息：
```javascript
// 在 login.js 的 onWechatLogin 方法中添加调试日志
console.log('Supabase URL:', 'https://ohfkiswsvhksaqtgeyby.supabase.co')
console.log('Request:', request)
```

2. 检查控制台输出，确认请求的完整 URL

3. 使用抓包工具查看实际请求
